ALTER TRIGGER TRI_PRODUTO_BU0 INACTIVE;
ALTER TRIGGER TRI_PROD_BU_HISTPRECOCUSTO INACTIVE;

update PRODUTO A
set A.COD_UNIDADE = A.CONV_UNIDADE,
    A.CONV_UNIDADE = A.COD_UNIDADE,
    A.PRECO_VENDA = coalesce(A.CONV_PRECO,A.PRECO_VENDA),
    A.CONV_PRECO = A.PRECO_VENDA,
	a.calc_custo_composicao = 'S',
    A.PRECO_CUSTO = (select sum(PC.CUSTO_TOTAL)
                     from PRODUTO_COMPOSICAO PC
                     where PC.ID_PRODUTO = A.CODIGO)
where A.CODIGO in (
43,44,50,52,55,56,57,58,59,60,62,63,64,65,66,73,77,78,82,83,84,86,89,90,91,94,96,99,101,103,105,124,130,132,133,137,141,146,147,148,155,160,161,178,179,180,181,182,183,184,202,206,385);
--select list(distinct(PC2.ID_PRODUTO), ',')
--                   from PRODUTO_COMPOSICAO PC2);

ALTER TRIGGER TRI_PRODUTO_BU0 ACTIVE;
ALTER TRIGGER TRI_PROD_BU_HISTPRECOCUSTO ACTIVE;
